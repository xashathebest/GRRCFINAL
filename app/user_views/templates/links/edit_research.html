{% load static %}
<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Edit Research - GRRC</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: {
                        poppins: ['Poppins', 'sans-serif'],
                    },
                },
            },
        }
    </script>
    <style type="text/tailwindcss">
        .sidebar {
            @apply fixed top-0 left-0 h-full w-64 bg-violet-500 text-white transition-all duration-300;
        }
        .sidebar.collapsed {
            @apply w-20;
        }
        .sidebar.collapsed .nav-text {
            @apply hidden;
        }
        .main-content {
            @apply ml-64 transition-all duration-300;
        }
        .main-content.expanded {
            @apply ml-20;
        }
        .nav-link {
            @apply flex items-center gap-4 px-6 py-3 text-white hover:bg-violet-600 transition-colors;
        }
        .nav-link.active {
            @apply bg-violet-600;
        }
        .form-group {
            @apply mb-6;
        }
        .form-label {
            @apply block text-sm font-medium text-gray-700 mb-2;
        }
        .form-input {
            @apply w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500 focus:border-transparent;
        }
        .form-textarea {
            @apply w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-violet-500 focus:border-transparent h-32;
        }
        .btn-primary {
            @apply px-6 py-3 bg-[#A51C30] text-white rounded-lg hover:bg-[#8b1728] transition-all duration-300 hover:shadow-lg;
        }
        .btn-secondary {
            @apply px-6 py-3 border border-gray-300 text-gray-700 rounded-lg hover:bg-gray-50 transition-all duration-300;
        }
    </style>
</head>
<body class="bg-gray-50">
    <!-- Sidebar -->
    <div id="sidebar" class="sidebar">
        <div class="p-6">
            <div class="flex items-center gap-4 mb-8">
                <img src="/static/links/grrc_img/GRRC Logo.png" alt="GRRC Logo" class="w-12 h-12">
                <span class="nav-text text-xl font-semibold">GRRC Admin</span>
            </div>
            <nav>
                <a href="{% url 'home' %}" class="nav-link">
                    <i class="fas fa-home"></i>
                    <span class="nav-text">Dashboard</span>
                </a>
                <a href="{% url 'article_list' %}" class="nav-link">
                    <i class="fas fa-newspaper"></i>
                    <span class="nav-text">Articles</span>
                </a>
                <a href="{% url 'pending_articles' %}" class="nav-link">
                    <i class="fas fa-clock"></i>
                    <span class="nav-text">Pending Articles</span>
                </a>
                <a href="{% url 'account_list' %}" class="nav-link">
                    <i class="fas fa-users"></i>
                    <span class="nav-text">User Management</span>
                </a>
                <a href="{% url 'research' %}" class="nav-link active">
                    <i class="fas fa-book"></i>
                    <span class="nav-text">Research</span>
                </a>
                <a href="{% url 'logout_view' %}" class="nav-link mt-auto">
                    <i class="fas fa-sign-out-alt"></i>
                    <span class="nav-text">Logout</span>
                </a>
            </nav>
        </div>
    </div>

    <!-- Main Content -->
    <div id="main-content" class="main-content">
        <div class="p-8">
            <div class="max-w-4xl mx-auto">
                <div class="flex justify-between items-center mb-8">
                    <h1 class="text-3xl font-bold text-gray-800">Edit Research</h1>
                    <button id="toggle-sidebar" class="text-gray-600 hover:text-gray-800">
                        <i class="fas fa-bars text-xl"></i>
                    </button>
                </div>

                <div class="bg-white rounded-lg shadow-lg p-8">
                    <form method="post" enctype="multipart/form-data">
                        {% csrf_token %}
                        <div class="form-group">
                            <label for="title" class="form-label">Title</label>
                            <input type="text" name="title" id="title" value="{{ research.title }}" class="form-input" required>
                        </div>

                        <div class="form-group">
                            <label for="content" class="form-label">Content</label>
                            <textarea name="content" id="content" class="form-textarea" required>{{ research.content }}</textarea>
                        </div>

                        <div class="form-group">
                            <label for="image" class="form-label">Image</label>
                            {% if research.image %}
                            <div class="mb-4">
                                <img src="{{ research.image.url }}" alt="Current Image" class="w-48 h-48 object-cover rounded-lg">
                            </div>
                            {% endif %}
                            <input type="file" name="image" id="image" accept="image/*" class="form-input">
                            <p class="mt-1 text-sm text-gray-500">Leave empty to keep current image</p>
                        </div>

                        <div class="form-group">
                            <label for="pdf_file" class="form-label">PDF File</label>
                            {% if research.pdf_file %}
                            <div class="mb-4">
                                <a href="{{ research.pdf_file.url }}" class="text-[#A51C30] hover:text-[#8b1728] flex items-center gap-1">
                                    <i class="fas fa-file-pdf"></i> Current PDF
                                </a>
                            </div>
                            {% endif %}
                            <input type="file" name="pdf_file" id="pdf_file" accept=".pdf" class="form-input">
                            <p class="mt-1 text-sm text-gray-500">Leave empty to keep current PDF</p>
                        </div>

                        <div class="flex justify-end gap-4">
                            <a href="{% url 'research' %}" class="btn-secondary">Cancel</a>
                            <button type="submit" class="btn-primary">Save Changes</button>
                        </div>
                    </form>
                </div>
            </div>
        </div>
    </div>

    <script>
        // Sidebar toggle functionality
        const sidebar = document.getElementById('sidebar');
        const mainContent = document.getElementById('main-content');
        const toggleButton = document.getElementById('toggle-sidebar');
        const toggleIcon = toggleButton.querySelector('i');

        toggleButton.addEventListener('click', () => {
            sidebar.classList.toggle('collapsed');
            mainContent.classList.toggle('expanded');
            toggleIcon.classList.toggle('fa-bars');
            toggleIcon.classList.toggle('fa-times');
        });

        // Image preview functionality
        const imageInput = document.getElementById('image');
        if (imageInput) {
            imageInput.addEventListener('change', function(e) {
                const file = e.target.files[0];
                if (file) {
                    const reader = new FileReader();
                    reader.onload = function(e) {
                        const preview = document.createElement('img');
                        preview.src = e.target.result;
                        preview.className = 'w-48 h-48 object-cover rounded-lg mt-4';
                        const previewContainer = imageInput.parentElement;
                        const existingPreview = previewContainer.querySelector('img');
                        if (existingPreview) {
                            existingPreview.remove();
                        }
                        previewContainer.appendChild(preview);
                    }
                    reader.readAsDataURL(file);
                }
            });
        }
    </script>
</body>
</html> 